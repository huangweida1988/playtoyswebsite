<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Paginated Video List</title>
    <!-- 引入jQuery -->
    <script src="js/jquery-3.7.1.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
        }

        .container {
            padding: 20px;
        }

        .video-list {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
        }

        .video-item {
            width: 220px;
            cursor: pointer;
            text-align: center;
        }

        .video-item img {
            width: 100%;
            height: auto;
        }

        .video-title {
            margin-top: 10px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .video-item:hover .video-title {
            white-space: normal;
        }

        .pagination {
            margin-top: 20px;
            text-align: center;
        }

        .pagination button {
            padding: 10px 20px;
            margin: 0 5px;
            background-color: #007bff;
            color: white;
            border: none;
            cursor: pointer;
            border-radius: 5px;
        }

        .pagination button:hover {
            background-color: #0056b3;
        }

        .pagination button.active {
            background-color: #0056b3;
        }
    </style>
</head>

<body>

    <div class="container">
        <h1>Recommended Videos</h1>
        <div id="video-list" class="video-list">
            <!-- 视频预览列表通过jQuery动态生成 -->
        </div>
        <!-- 分页按钮 -->
        <div class="pagination" id="pagination">
            <!-- 分页按钮通过jQuery动态生成 -->
        </div>
    </div>


    <script>
        $(document).ready(function () {
            const itemsPerPage = 12;  // 每页显示12个视频
            let currentPage = 1;
            let totalPages = 0;
            let videos = [];
            // let videos = [
            //     {
            //         "title": "Sample Video 1",
            //         "thumbnail": "https://via.placeholder.com/150",
            //         "video": "video1.mp4"
            //     },
            //     {
            //         "title": "Sample Video 2",
            //         "thumbnail": "https://via.placeholder.com/150",
            //         "video": "video2.mp4"
            //     },
            //     {
            //         "title": "Sample Video 3",
            //         "thumbnail": "https://via.placeholder.com/150",
            //         "video": "video3.mp4"
            //     },
            //     {
            //         "title": "Sample Video 4",
            //         "thumbnail": "https://via.placeholder.com/150",
            //         "video": "video4.mp4"
            //     }
            // ];
            // totalPages = Math.ceil(videos.length / itemsPerPage);
            

            // 渲染当前页的视频
            function renderPage(page) {
                $('#video-list').empty();  // 清空当前视频列表
                const startIndex = (page - 1) * itemsPerPage;
                const endIndex = Math.min(startIndex + itemsPerPage, videos.length);
                for (let i = startIndex; i < endIndex; i++) {
                    const video = videos[i];
                    const videoItem = `
                    <div class="video-item" data-video="${video.video}">
                        <img src="${video.thumbnail}" alt="${video.title}">
                        <p class="video-title">${video.title}</p>
                    </div>`;
                    $('#video-list').append(videoItem);
                }

                // 添加点击事件跳转到播放页面
                $('.video-item').click(function () {
                    const videoSrc = $(this).data('video');
                    window.location.href = 'video_player.html?video=' + videoSrc;
                });
            }

            // 渲染分页按钮
            function renderPagination() {
                $('#pagination').empty();  // 清空当前的分页按钮
                for (let i = 1; i <= totalPages; i++) {
                    const pageButton = `<button class="${i === currentPage ? 'active' : ''}" data-page="${i}">${i}</button>`;
                    $('#pagination').append(pageButton);
                }

                // 分页按钮点击事件
                $('#pagination button').click(function () {
                    currentPage = parseInt($(this).data('page'));
                    renderPage(currentPage);  // 渲染点击的页数
                    renderPagination();  // 更新分页按钮
                });
            }

            // 从TXT文件读取数据
            // $.get('datas.txt', function (data) {
            //     videos = JSON.parse(data);  // 解析JSON数据
            //     totalPages = Math.ceil(videos.length / itemsPerPage);  // 计算总页数
            //     renderPage(currentPage);  // 渲染第一页
            //     renderPagination();  // 渲染分页按钮
            // });

            const request = new XMLHttpRequest();
            request.open("GET", "datas.txt")
            request.send(null)
            request.onload = function () {
                if (request.status == 200) {
                    if (isJSON(request.responseText)) {
                        videos = JSON.parse(data);
                        totalPages = Math.ceil(videos.length / itemsPerPage);
                        // 初始渲染第一页和分页按钮
                        renderPage(currentPage);
                        renderPagination();
                    }
                }
            }
        });
    </script>

</body>

</html>